<!DOCTYPE html>
<html lang="en" ng-app="app">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>Carsten</title>    

		<link href="/components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"></link>
		<link href="/css/index.css" rel="stylesheet" />
		
		<!-- Bower Dependencies -->
		<script type="text/javascript" src="/components/jquery/dist/jquery.min.js"></script>
		<script type="text/javascript" src="/components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="/components/angular/angular.min.js"></script>
		<script type="text/javascript" src="/components/angular-route/angular-route.min.js"></script>
		<script type="text/javascript" src="/components/angular-bootstrap/ui-bootstrap.min.js"></script>
		<script type="text/javascript" src="/components/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>

		<script src="/socket.io/socket.io.js"></script>

		<script type="text/javascript" src="/app.js"></script>
		<script type="text/javascript" src="/controllers/RootCtrl.js"></script>
	</head>
	<body ng-controller="RootCtrl">
		<div class="container">
			<div class="jumbotron">
					<h1>Carsten &#10084;</h1>
					<p>
						With Carsten you can <strong>carst</strong> content to screens within your network.<br>
					</p>
				<div class="dropdown" style="float:right;">
					<strong>You are on</strong>
					<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown">
						<span ng-bind="channel"></span>
						<span class="caret"></span>
					</button>
					<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
						<li role="presentation"><a role="menuitem" tabindex="-1" href="#" ng-repeat="channel in channels" ng-click="setChannel(channel)">{{channel}}</a></li>
					</ul>
				</div>
					<form class="form-inline" role="form">
					  <div class="form-group">
					    <input type="text" style="width:300px;" ng-model="input" ng-keyup="inputKeyup($event)" class="form-control" placeholder="Enter something :)">
						  <input type="text" style="width:70px;" ng-model="inputDuration" ng-keyup="inputKeyup($event)" class="form-control" placeholder="mm:ss">
					  </div>
							<div class="btn-group">
							  <button type="button" class="btn" ng-click="carst(input, channel, inputDuration)">
								  <span class="glyphicon glyphicon-transfer"></span> Carst to {{countReceivers[channel] > 1 ? countReceivers[channel] + ' receivers' : (countReceivers[channel] == 1 ? countReceivers[channel] + ' receiver' : 'nobody')}}
							  </button>
							</div>
						<h3>Default carst</h3>
						<div class="form-group">
							<input type="text" style="width:300px;" ng-model="defaultCarst[channel].url" class="form-control" placeholder="Enter something :)">
						</div>
						<div class="btn-group">
							<button type="button" class="btn" ng-click="setDefault(defaultCarst[channel].url, channel)">
								<span class="glyphicon glyphicon-floppy-disk"></span> Set
							</button>
						</div>
					</form>
				<h3>Carsts</h3>
					<div ng-show="carsts[channel].length == 0">
						<li class="list-group-item">No casts available.</li>
					</div>
					<div ng-show="carsts[channel].length > 0" class="panel panel-default">
						<div class="panel-body">
							<div ng-repeat="carst in carsts[channel]" style="height:45px;" ng-class="$index !== 0 ? 'borderTop' : ''">
								<div style="position: relative;">
									<div style="position:absolute; left:10px; top:12px; display: inline-block; border-right:1px solid #cccccc; width:40px;">{{ carst.id }}</div>
									<div style="position:absolute; left:60px; top:12px; display: inline-block;" ng-bind-html="carst.title | to_html"></div>
									<div style="position:absolute; right:150px; top:12px; display: inline-block;">{{ carst.timeString }}</div>
									<div style="position:absolute; right:20px; top:6px; display: inline-block; width:80px;"><button type="button" class="btn" ng-click="deleteCarst(carst, channel)"><span class="glyphicon glyphicon-remove"></span> Delete</button></div>
								</div>
							</div>
						</div>
					</div>
				<!-- Modal -->
				<div class="modal fade" id="addPlaylist" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
								<h4 class="modal-title" id="myModalLabel">Add new playlist</h4>
							</div>
							<div class="modal-body" style="padding:20px 50px;">
								<input id="playlistTitle" class="contenteditable" value="Title of your new playlist" />
								<ul  class="list-group">
									<div id="newPlaylist">
										<li style="display: block;" class="list-group-item" ng-repeat="carst in newPlaylist">
											<div style="outline:0; margin-top:10px !important;" id="newPlaylistCarstTime_{{$index}}"  class="badge" contenteditable="true">{{carst.timeString}}</div>
											<input id="newPlaylistCarstUrl_{{$index}}" class="newCarst contenteditable" value="{{carst.url}}" />
										</li>
									</div>
									<div style="cursor:pointer; display:inline-block; position: absolute; right:0; margin-right:50px; margin-top:8px;" ng-click="appendCarstToPlaylist()"> <span class="glyphicon glyphicon-plus"></span> Carst</div>
								</ul>
							</div>
							<div class="modal-footer">
								<div id="newPlaylistSuccess" class="alert alert-success" role="alert">Well done, the playlist was successfully added to the database!</div>
								<div id="newPlaylistError" class="alert alert-danger" role="alert">Something is wrong! Please check your inputs!</div>
								<button type="button" class="btn" data-dismiss="modal"><span class="glyphicon glyphicon-remove"></span> Close</button>
								<button type="button" class="btn" ng-click="applyNewPlaylist()"><span class="glyphicon glyphicon-refresh"></span> Apply</button>
								<button type="button" class="btn" ng-click="saveNewPlaylist()"><span class="glyphicon glyphicon-floppy-disk"></span> Save changes</button>
							</div>
						</div>
					</div>
				</div>
				<div style="position: relative;">
					<h3>Available Playlists</h3>
					<div style="position:absolute; cursor: pointer; font-size:24px; top:0; right:0; display:inline-block;" ng-click="resetPlaylist()" data-toggle="modal" data-target="#addPlaylist">Add <span class="glyphicon glyphicon-plus"></span></div>
				</div>
				<div ng-show="playlists.length == 0">
					<li class="list-group-item">No playlists available.</li>
				</div>
				<div ng-show="playlists.length > 0" class="panel panel-default">
					<div class="panel-body">
						<div ng-repeat="playlist in playlists" ng-class="$index !== 0 ? 'borderTop' : ''" style="position: relative;">
							<div style="margin:10px;">
								<div>
									<div  style="display:inline;"><strong>{{ playlist.title }}</strong> </div>
									<div style="position:absolute; right: 20px; display: inline-block; cursor: pointer;" ng-click="play(playlist)"><span class="glyphicon glyphicon-play"></span></div>
									<div style="cursor:pointer; position:absolute; right:0; display:inline;" ng-click="removePlaylist($index)"><span class="glyphicon glyphicon-remove"></span></div>
								</div>
								<div ng-repeat="carst in playlist.carsts" style="position: relative;">
									<div style="position:absolute; left:10px; display: inline-block; width:40px;">{{ carst.id }}</div>
									<div style="margin-left:40px; display: inline-block;" ng-bind-html="carst.title | to_html"></div>
									<div style="position:absolute; right: 50px; display: inline-block;">{{ carst.timeString }}</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<h3>Commands history (max. 5)</h3>
				<div ng-show="commands[channel].length == 0">
					<li class="list-group-item">No commands.</li>
				</div>
				<div ng-show="commands[channel].length > 0" class="panel panel-default">
					<div class="panel-body">
						<div ng-repeat="command in commands[channel] | orderBy : 'id' : true | limitTo:5 " style="height:45px;" ng-class="$index !== 0 ? 'borderTop' : ''">
							<div style="position: relative;">
								<div style="position:absolute; left:10px; top:12px; display: inline-block;">{{ command.command }}</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
  </body>
</html>